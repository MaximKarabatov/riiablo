application {
    mainClass = 'com.riiablo.map.MapViewer'
}

run {
  workingDir = rootProject.file('assets').path
  setIgnoreExitValue(true)

  // Required to run LWJGL3 java apps on MacOS
  if (org.gradle.internal.os.OperatingSystem.current() == org.gradle.internal.os.OperatingSystem.MAC_OS) {
    jvmArgs += "-XstartOnFirstThread"
  }
}

jar {
  archiveBaseName = project.name
  dependsOn configurations.runtimeClasspath
  from { configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) } }
  manifest {
    attributes 'Main-Class': application.mainClass
  }

  doLast {
    file(archiveFile).setExecutable(true, false)
  }
}
